---
layout: post
title: ğŸ’­ Data Class Comp | Dataset & Data Generation
date: 2021-08-24 07:44 +0900
#modified: 2021-07-30 18:49 +0900
description: ì´ë¯¸ì§€ ë¶„ë¥˜ ëŒ€íšŒë¥¼ ìœ„í•œ ëª¨ë¸ì„ ë§Œë“œëŠ” ê³¼ì •
tag:
  - Boostcamp AI
  - P-stage
  - Data Classification Competition
# image: /cara-memperbarui-fork-repository/repo.png
usemathjax: true
---

# Dataset

### Pre-processing

* ì–´ë–¤ í˜•íƒœì¸ì§€ ëª¨ë¥´ëŠ” ë°ì´í„°(Vanilla Data)ë¥¼ ëª¨ë¸ì´ ì¢‹ì•„í•˜ëŠ” í˜•íƒœì˜ Datasetìœ¼ë¡œ ë§Œë“¤ì–´ ì¤˜ì•¼í•¨
* 80%ì˜ ì‹œê°„ì´ ë°ì´í„° ì „ì²˜ë¦¬í•˜ëŠ”ë°ì— ì“°ì„
  * ë…¸ì´ì¦ˆ, Nullê°’ ë“± ì“¸ ìˆ˜ ì—†ëŠ” ë°ì´í„°ê°€ ì‚¬ì‹¤ìƒ ë§ìŒ
  * ì§ˆ ì¢‹ì€ ë°ì´í„°ë¥¼ ëª¨ë¸ì— ë„£ì–´ì£¼ëŠ” ê²ƒì´ ì„±ëŠ¥ ê°œì„ ì˜ í•µì‹¬

* ì˜ˆì‹œë“¤
  * Bounding Box: ì›í•˜ëŠ” ê°ì²´ë§Œ ë½‘ìŒ
  * Resize: ë‹¤ì–‘í•œ ì‚¬ì´ì¦ˆ íšì¼í™”, í° ìš©ëŸ‰ì˜ ì´ë¯¸ì§€ ì¶•ì†Œ -> ì‘ì—…ì˜ íš¨ìœ¨í™”

### Generalization

* Underfitting: High bias, Overfitting: High variance
* Validation set: í•™ìŠµí•œ ëª¨ë¸ ê²€ì¦í•˜ê¸° ìœ„í•´ train set ì¤‘ ì¼ì • ë¶€ë¶„ì„ ë½‘ì•„ ë†“ìŒ

### Data Augmentation

* Generalizationì˜ í•œ ë°©ë²•
* ì£¼ì–´ì§„ ë°ì´í„°ê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ê²½ìš°(case)ì™€ ìƒíƒœ(state)ì˜ ë‹¤ì–‘ì„±ì„ ê³ ë ¤í•¨
* ì¦‰, ë…¸ì´ì¦ˆê°€ ìˆëŠ” ë°ì´í„°ë¥¼ ë³´ë”ë¼ë„ Robustí•˜ê²Œ ì²˜ë¦¬ ê°€ëŠ¥
* `torchvision.transforms` í™œìš©
  * ê³¼ì—° ì˜ë¯¸ìˆëŠ” ë³€ìˆ˜ì¸ì§€ë„ ê³ ë ¤í•˜ê¸°, ë¬´ì˜ë¯¸í•œ ì²˜ë¦¬ ë°©ì‹ì€ ì‚¬ìš©í•˜ì§€ ì•Šê¸°
  * ex. ë§ˆìŠ¤í¬ ì´ë¯¸ì§€ë¥¼ ìœ„ì•„ë˜ë¡œ flip

```py
transforms.Compose([
  Resize((96,128), Image.BILINEAR),
  RandomRotation([-8,+8]),
  ...
  ToTensor(),
  Normalize(mean=self.mean, std=self.std),
  AddGaussianNoise(0.,1.)
])

image = self.read_image(index)
image_transform = self.transform(image)
```

* `albumentations`: ë” ë¹ ë¥´ê³  ë‹¤ì–‘í•œ transform ì œê³µí•˜ëŠ” íŒ¨í‚¤ì§€ (download from Github)

### â—ï¸Caution

* There is no absolute answer for data augmentation!
* You need to prove validity of the augmentation through multiple experiments

# Data Generation

### Data Feeding

* ë¨¹ì´ë¥¼ ì£¼ë‹¤ = ëŒ€ìƒì˜ ìƒíƒœë¥¼ ê³ ë ¤í•´ì„œ ì ì •í•œ ì–‘ì„ ì¤€ë‹¤
* ëª¨ë¸ì´ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì–‘ì„ ê³ ë ¤í•´ì•¼í•¨
* ëª¨ë¸ì˜ ì²˜ë¦¬ëŸ‰ë§Œí¼ ë°ì´í„°ë¥¼ generateí•˜ëŠ”ê°€?

<figure>
<img src="/assets/img/IMG_1267.jpg" alt="Feeding">
<figcaption>Fig 1. Data generatorì™€ Modelì˜ ë°ì´í„° ì²˜ë¦¬ëŸ‰ ë¹„êµ</figcaption>
</figure>

<figure>
<img src="/assets/img/IMG_1268.jpg" alt="Feeding">
<figcaption>Fig 2. Dataset ìƒì„± ëŠ¥ë ¥ ë¹„êµ</figcaption>
</figure>

* ì–´ë– í•œ ë³€í˜•ì€ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ë‚®ì¶”ê¸°ë„ í•¨
* ì—¬ëŸ¬ê°€ì§€ ì¡°í•©ì„ í•´ë³´ë©´ì„œ íŠœë‹ê³¼ì •ì´ í•„ìš”í•¨

### torch.utils.data

* **Dataset** êµ¬ì¡°

```py
from torch.utils.data import Dataset

class myDataset(Dataset): # Dataset ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒì†
  def __init__(self): # MyDataset í´ë˜ìŠ¤ê°€ ì²˜ìŒ ì„ ì–¸ë˜ì—ˆì„ ë•Œ í˜¸ì¶œ
    pass
  
  def __getitem__(self,index): # MyDatasetì˜ ë°ì´í„° ì¤‘ index ìœ„ì¹˜ì˜ ì•„ì´í…œì„ ë¦¬í„´
    return None
  
  def __len__(self): # MyDataset ì•„ì´í…œì˜ ì „ì²´ ê¸¸ì´
    return None
```

* **DataLoader**: ë‚´ê°€ ë§Œë“  Datasetì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ê´€ë ¨ ê¸°ëŠ¥ ì¶”ê°€
* êµ‰ì¥íˆ ë§ì€ ê¸°ëŠ¥ë“¤ì„ ì œê³µ
  * shuffle
  * sampler
  * collate_fn ë“±

```py
train_loader = torch.utils.data.DataLoader(
  train_set,
  batch_size = batch_size,
  num_workers = num_workers,
  drop_last = True
)

# -> (Batch, Channel, Height, Width)
```

* Datasetê³¼ DataLoaderëŠ” **ë¶„ë¦¬ë˜ëŠ” ê²ƒ**ì´ ì¢‹ìŒ
* ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•´ì§€ê³  íš¨ìœ¨ì´ ì˜¬ë¼ê°€ê¸° ë•Œë¬¸