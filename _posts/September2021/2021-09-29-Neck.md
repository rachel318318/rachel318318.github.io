---
layout: post
title: ğŸ” Object Detect Comp | Neck
date: 2021-09-29 07:44 +0900
#modified: 2021-07-30 18:49 +0900
description: ê°ì²´ ê²€ì¶œ ëŒ€íšŒë¥¼ ìœ„í•œ ëª¨ë¸ì„ ë§Œë“œëŠ” ê³¼ì •
tag:
  - Boostcamp AI
  - P-stage
  - Object Detection Competition
# image: /cara-memperbarui-fork-repository/repo.png
usemathjax: true
---

Neckì´ë€ ë¬´ì—‡ì¸ê°€?

2 stage detector

ë§ˆì§€ë§‰ feature mapë§Œì„ ê¼­ ì‚¬ìš©í•´ì•¼í•˜ëŠ”ê°€?

ì¤‘ê°„ Featureë¥¼ ì‘ìš©í•´ì„œ ROIë¥¼ ë½‘ì•„ë„ ë˜ì§€ ì•Šì„ê¹Œ?

Neckì€ ì™œ í•„ìš”í•œê°€?

í° ê°ì²´, ì‘ì€ ê°ì²´,,,

ì‘ì€ ê°ì²´ â†’ low level

í° ê°ì²´ â†’ backboneì„ ì¶©ë¶„íˆ í†µê³¼í•œ high level

- ë‹¤ì–‘í•œ í¬ê¸°ì˜ ê°ì²´ë¥¼ ë” ì˜ íƒì§€í•˜ê¸° ìœ„í•´ì„œ
- OD ì‘ì€ ê°ì²´ë¥¼ ì˜ ëª» ì¡ëŠ” ê²ƒì´ ë¬¸ì œ

High level feature map

Low level feature mapì—ì„œ region ë½‘ìœ¼ë©´ ë˜ì§€ ì•Šì€ê°€?

í•˜ì§€ë§Œ ì„ì–´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤

high level â†’ semantic ë§ì§€ë§Œ localization ì •ë³´ê°€ ì—†ë‹¤

- í•˜ìœ„ levelì˜ featureëŠ” semantic...

ì›ë˜ëŠ” ë§ˆì§€ë§‰ feature mapë§Œì„ ì‚¬ìš©í•´ì„œ RPN, predictionì„ ì§„í–‰í–ˆë‹¤ë©´

ì´ì œëŠ” 

FPN

low level featureë¥¼ ì–´ë–»ê²Œ í™œìš©í•  ìˆ˜ ìˆëŠ”ê°€?

ì´ë¯¸ì§€ì˜ í¬ê¸°ë¥¼ ì‘ê²Œ í¬ê²Œ

ì¤‘ê°„ ì´ë¯¸ì§€ ì‘ì€ ì´ë¯¸ì§€ë¡œ feature ë½‘ì•„ì„œ ì´ë¯¸ì§€ì˜ í¬ê¸° ìì²´ë¥¼ ì¡°ì ˆí•˜ëŠ” ê²ƒ

- top-down path way ì¶”ê°€
- ì¤‘ê°„ feature mapì„ ê·¸ëŒ€ë¡œ í™œìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ
- high levelì˜ ì •ë³´ë¥¼ low levelë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒ

Bottom-up

Backbone neural netì„ í†µê³¼í•˜ëŠ” ê²ƒ

Top-down

High level feature ì •ë³´ë¥¼ low level feature ì •ë³´ì—ê²Œ ì „ë‹¬í•˜ëŠ” ê²ƒ

lateral connection

Bottom-upì—ì„œ ë‚˜ì˜¨ feature mapê³¼ Top-downì„ í•©ì³ì•¼í•œë‹¤

Bottom-upê³¼ì • â†’ ì±„ë„ ìˆ˜ ë¶€ì¡±í•¨ â†’ 11 conv

Top-down â†’ ì´ë¯¸ì§€ í¬ê¸°ê°€ ì‘ìŒ â†’ upsampling

- Nearest Neighbor Upsamling

Pipeline

Backbone

ResNet

- 4ê°œì˜ stage
- poolingì„ í†µí•´ì„œ width heightê°€ ì ˆë°˜ìœ¼ë¡œ ì¤„ì–´ë“¬

ê° ìŠ¤í…Œì´ì§€ì—ì„œì˜ feature mapì´ RPN í†µê³¼ì‹œí‚¤ê³  ROIê°€ ë„ì¶œë¨

Object scoreê°€ ë†’ì€ ROI Nê°œë¥¼ ë½‘ê³  NMSì„ í†µí•´ 1000ê°œì˜ ROIë¥¼ ì„ íƒí•¨

ì´ ROIê°€ ì–´ë”” feature mapì—ì„œ ì™”ëŠ”ê°€?(P5? P4?) â†’ stage mappingê³¼ì •ì´ í•„ìš”í•¨ â†’ ì‹ ppt ì°¸ê³ 

Contribution

Summary

Code

PANet

Problem in FPN

- Top down feature map
- ì‹¤ì œ ë°±ë³¸ì´ ì—„ì²­ ê¹Šê¸°ë•Œë¬¸ì— poolingê³¼ì •ì—ì„œ low-level featureê°€ high-level featureë¡œ ì˜ ì „ë‹¬ë˜ê² ëŠ”ê°€?

Bottom-up Path Augmentation

Top-down í•œ feature mapì„ ë‹¤ì‹œ í•œë²ˆ Bottom-up í•´ì¤€ ê²ƒ

Adaptive Feature Pooling

PANetì€ instance segmentationì„ ìœ„í•œ í˜ì´í¼ì´ë¯€ë¡œ ROIAlignìœ¼ë¡œ ì í˜€ìˆë‹¤

ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” ROI Poolingìœ¼ë¡œ ì´í•´í•˜ë©´ ëœë‹¤

Feature map â†’ RPN â†’ ROI

ëª‡ ë²ˆì§¸ stageì— ìˆëŠ” ROIì¸ê°€? ì˜† ê³µì‹ì„ í†µí•´ì„œ ì •í•¨

í•˜ì§€ë§Œ,,, ê²½ê³„ì— ìˆëŠ” ROIì— ëŒ€í•´ì„œëŠ” ì˜ ëŒ€ì‘í•  ìˆ˜ ì—†ë‹¤

10 í”½ì…€ì˜ ì°¨ì´ë§Œìœ¼ë¡œë„ stage 3,4 ë“± ë°”ë€” ìˆ˜ ìˆë‹¤

ROIëŠ” ë³„ ì°¨ì´ ì—†ì§€ë§Œ featureë¥¼ ë½‘ëŠ” feature mapì— í° ì°¨ì´ê°€ ìƒê¸´ë‹¤

ê·¸ë˜ì„œ projectioní•˜ëŠ” ê³¼ì •ì—ì„œ íŠ¹ì • ìŠ¤í…Œì´ì§€ì˜ feature mapìœ¼ë¡œ projectioní•˜ê²Œ ë˜ë©´ ë§ì€ ì •ë³´ë¥¼ í™œìš©í•  ìˆ˜ ì—†ë‹¤

ROIë¥¼ í•˜ë‚˜ì˜ feature mapë§Œì„ í™œìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ëª¨ë“  í”¼ì²˜ë§µì„ ì‚¬ìš©í•˜ì—¬ ROI projectioní•˜ì

ROI poolingí•˜ì—¬ FCLë¡œ ë§Œë“¤ê³  ì ì ˆí•˜ê²Œ max poolingí•˜ì—¬ feature mapì„ ë§Œë“¤ì

Code

After FPN

Neckì— ëŒ€í•œ ì—°êµ¬ê°€ í™œë°œíˆ ì¼ì–´ë‚¨

DetectoRS

- Looking and thinking twice
    - RPN ê°ì²´ê°€ ìˆì„ë²•í•œ ìœ„ì¹˜ë¥¼ ìƒê°í•˜ê³  regression
    - ë­”ê°€ ë°˜ë³µì ìœ¼ë¡œ í•˜ë©´ ì¢‹ì€ ì„±ëŠ¥ì´ ë‚˜ì˜¤ë‚˜?

Recursive Feature Pyramid

Switchable Atrous...

Recursive Feature Pyramid

FPNì´ë‘ ê±°ì˜ ë™ì¼í•˜ì§€ë§Œ

FPNì—ì„œ ë‹¤ì‹œ ë°±ë³¸ìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤

Neck ì •ë³´ë¥¼ ë°±ë³¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡

High level featureê°€ low level featureë¡œ ì „ë‹¬ë¼ ëª¨ë“  ì •ë³´ë¥¼ í™œìš©í•  ìˆ˜ ìˆì§€ë§Œ í•˜ì§€ë§Œ ë°±ë³¸ ì—°ì‚°ì„ ë” í•´ì•¼í•œë‹¤ëŠ” ì  â†’ í•™ìŠµ ì†ë„ê°€ ëŠë¦¬ë‹¤

ASPPê³¼ì •ìœ¼ë¡œ FPNì •ë³´ë¥¼ ë°±ë³¸ìœ¼ë¡œ ë„˜ê¸´ë‹¤

Atrous convolution

Receptive fieldë¥¼ ëŠ˜ë¦¬ëŠ” ê²ƒ

í•˜ë‚˜ì˜ feature mapì—ì„œ poolingì„ ì§„í–‰í•˜ëŠ”ë° ì—¬ëŸ¬ë²ˆ Atrous convolution ì ìš©í•˜ì—¬ concatí•´ì„œ ì‚¬ìš©

BiFPN

Pipeline

ë‘ê°œì˜ ë…¸ë“œë¥¼ ì—†ì•° â†’ feature mapì´ í•œ ê³³ì—ì„œë§Œ ì˜¤ëŠ” ë° â†’ íš¨ìœ¨ì„±ì„ ë†’ì´ê¸° ìœ„í•´

ë¸”ë¡ì„ ìŒ“ìŒ

Weighted Feature Fusion

High level feature mapê³¼ Low level feature mapì„ ë‹¨ìˆœ summation í•˜ë©´ ì •ë³´ê°€ ì œëŒ€ë¡œ ì„ì¼ ìˆ˜ ì—†ë‹¤

feature ë³„ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ë‘”ë‹¤

NAS-FPN

ë°ì´í„°ë¥¼ ë°”ë€ë‹¤ë˜ê°€ ë°±ë³¸ì´ ë°”ë€Œë©´ ë‹¤ì‹œ ëŒë ¤ì•¼í•¨

ë¹„ìš©ì´ ë§ì´ ë“ ë‹¤

AugFPN

Residual Feature Augmentation

C5ìœ¼ë¡œ ë¶€í„° M6ë¥¼ ë§Œë“¤ì–´ì£¼ê³ 

Top downì •ë³´ì— ì¶”ê°€ëœë‹¤

ë‹¤ì–‘í•œ ìŠ¤ì¼€ì¼ë¡œ pooling

Adaptive Spatial Fusion

ë™ì¼í•œ ì‚¬ì´ì¦ˆë¡œ upsamplingí•œë‹¤ìŒ

concatì„ í•˜ì—¬

conv ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤

Sigmoidë¥¼ í†µê³¼í•˜ë©´ ê° í”½ì…€ì˜ ê°€ì¤‘ì¹˜ë¥¼ êµ¬í•˜ê²Œ ëœë‹¤ â†’ spatial weight

Soft ROI Selection

ì§•ì°¨ ëª¨ë¼ëŠ”ê±°ì•¼,,,,