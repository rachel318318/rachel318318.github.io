---
layout: post
title: ğŸ” Object Detect Comp | Ready for Competition
date: 2021-10-06 07:44 +0900
#modified: 2021-07-30 18:49 +0900
description: ê°ì²´ ê²€ì¶œ ëŒ€íšŒë¥¼ ìœ„í•œ ëª¨ë¸ì„ ë§Œë“œëŠ” ê³¼ì •
tag:
  - Boostcamp AI
  - P-stage
  - Object Detection Competition
# image: /cara-memperbarui-fork-repository/repo.png
usemathjax: true
---

### mAPì— ëŒ€í•œ ì˜¤í•´

- ì‚¬ëŒ ëˆˆì— ë³´ì´ê¸°ì—ëŠ” ìš°ì¸¡ ì‚¬ì§„ì´ ë¬´ì°¨ë³„ì ìœ¼ë¡œ bboxë¥¼ ì¹œ ê±¸ë¡œ ë³´ì´ì§€ë§Œ
- bbox thresholdë¥¼ ë†’ê²Œ ì¤€ ê²½ìš° (class score: 0.5 ì´ìƒì¸ ê²ƒë§Œ ì¹˜ê¸°)
- bbox thresholdë¥¼ ë‚®ê²Œ ì¤€ ê²½ìš°ê°€ mAPê°€ ë” ë†’ê²Œ ë‚˜ì˜¨ë‹¤
- ì•™ìƒë¸” â†’ ë°•ìŠ¤ ê°¯ìˆ˜ê°€ ë§ì•„ì§€ë©´ì„œ mAPê°€ ë†’ì•„ì§ˆ ìˆ˜ ìˆìŒ
- ì‹¤ì œ ì—°êµ¬ì—ì„œëŠ” threshold 0.05ë¡œ ë‘”ë‹¤

### ëŒ€íšŒ ì¤€ë¹„ ìˆœì„œ

1. EDA
2. íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
    1. ë¼ì´ë¸ŒëŸ¬ë¦¬
    2. ê°œì¸ ì½”ë“œ
    3. ê³µìœ ëœ ì½”ë“œ
    4. ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œ êµ¬ì¶•
3. Validation set ì°¾ê¸°
4. ì„±ëŠ¥ì„ ì˜¬ë¦¬ê¸° ìœ„í•œ ì‹œë„ ë°˜ë³µ

### EDA

```python
from pycocotools.coco import COCO
import matplotlib.pyplot as plt
import matplotlib.patches as patches

data_dir = ('/home/data/data')

img_id = coco.getImgIds(imgIds=5)
img_info = coco.loadImgs(img_id)[0]

img = cv2.imread(os.path.join(data_dir, img_info['file_name']))
img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB).astype(np.float32)

plt.figure(figsize=(8,8))
plt.xticks([]); plt.yticks([])
plt.imshow(img)
```

- ê°ì²´ê°€ ëŒ€ë¶€ë¶„ ê°€ìš´ë° ìˆë‹¤?
- í•œ ì´ë¯¸ì§€ì— ì—¬ëŸ¬ê°œì˜ classê°€ ìˆì„ ìˆ˜ë„ ìˆêµ¬ë‚˜~

```python
from collections import Counter

categories = train_ann['categories']

def id2cname(c_id):
	return categories[c_id]['name']

ids = [id2cname(ann['category_id'])] for ann in train_ann['annotations']]
counts = Counter(ids)

plt.figure(figsize=(8,8))
plt.bar(counts.keys(), counts.values())
plt.show()
```

- Paper, plastic bag ë“± ë§ì€ë° ë‚˜ë¨¸ì§€ëŠ” ë³„ë¡œ ì—†ëŠ” classë„ ìˆë‹¤
- í•˜ë‚˜ì˜ ì´ë¯¸ì§€ì— objectê°€ 1ê°œì¸ ê²½ìš°,,, ë“±ë“±
- masterë‹˜ì€ 40ì •ë„ì—ì„œ ëŠì–´ì„œ í•™ìŠµí•  ê²ƒ ê°™ë‹¤ â†’ ê·¸ ì´ìƒì˜ ìˆ«ìëŠ” ì˜¤íˆë ¤ í•™ìŠµì— ë°©í•´ë  ìˆ˜ë„?
- bounding box ë¶„í¬
    - (512,512) ë“±
- í´ë˜ìŠ¤ ë³„ bbox ì‚¬ì´ì¦ˆ í‰ê· 
- í´ë˜ìŠ¤ ê°„ ë“±ì¥ ìƒê´€ê´€ê³„
    - ìƒê´€ê´€ê³„ê°€ ë†’ì€ ê²Œ ì—†ë‹¤

### ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ ì •í•˜ê¸°

- YOLO, Faster R-CNN, RetinaNet...
- ì–´ë–¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©?, ì§ì ‘ êµ¬í˜„?, ë‹¤ë¥¸ ì‚¬ëŒ ê³µìœ í•œ ì½”ë“œ?
- ì´ë¯¸ì§€ â†’ 'Submission file'ê¹Œì§€ì˜ ëª¨ë“  ê³¼ì •ì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì„ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•ì´ë¼ê³  í•¨

### Validation set ì „ëµ

- Random split
- Stratified k-fold
- Group k-fold

### ì„±ëŠ¥ ì˜¬ë¦¬ê¸°

- albumentations
- cutmix
- mosaic
- Ensemble, TTA â†’ bboxê°€ ë§ì´ ë‚˜ì˜¤ê²Œ ë¨
    - NMS, soft-NMS, WBF
- Ensemble
    - seed ensemble
        - ëª¨ë¸, loss, optimizer ë“± ëª¨ë“  ì¡°ê±´ ê°™ìŒ
    - Framework ensemble
        - Mmdetection + detectron ë˜ëŠ” pytorch + tensorflow + torchvision
        - ë‹¤ì–‘ì„±ì´ ì¶”ê°€ë  ìˆ˜ë¡ ì¢‹ìŒ
    - snapshot ensemble
        - ë™ì¼í•œ ì•„í‚¤í…ì²˜ì´ì§€ë§Œ ì„œë¡œ ë‹¤ë¥¸ local minimaì— ë¹ ì§„ ì‹ ê²½ë§ì„ ì•™ìƒë¸” í•˜ëŠ” ë°©ë²•
    - Stochastic weight averaging
        - ì¼ì •í•œ stepë§ˆë‹¤ weightë¥¼ ì—…ë°ì´íŠ¸ì‹œí‚¤ëŠ” SGDì™€ ë‹¬ë¦¬, ì¼ì • ì£¼ê¸°ë§ˆë‹¤ weightë¥¼ í‰ê·  ë‚´ëŠ” ë°©ë²•

### ì»´í”¼í‹°ì…˜ìœ¼ë¡œ í•™ìŠµí•˜ëŠ” ë°©ë²•

- ì»´í”¼í‹°ì…˜ ì§„í–‰ ì¤‘ì—” ì¼ë‹¨ ì‹œë„, ì¤‘ìš”í•œ íŒŒë¼ë¯¸í„° ìœ„ì£¼ë¡œ ì´í•´
- ì»´í”¼í‹°ì…˜ í›„ ë…¼ë¬¸ ì°¾ì•„ ì½ì–´ë³´ë©° ê°ê°ì˜ ì˜ë¯¸ ìœ„ì£¼ë¡œ ì´í•´
- ì»´í”¼í‹°ì…˜ ì§„í–‰í•  ë•Œ ë°°ìš´ ì§€ì‹ì˜ ë‹¨í¸ë“¤ì„ ì»´í”¼í‹°ì…˜ ëë‚˜ê³  ì´ì–´ì£¼ëŠ” ê³µë¶€ì‹œê°„ì´ í•„ìš”