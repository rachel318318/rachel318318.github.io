---
layout: post
title: ğŸ­ Semantic Seg Comp | FCN
date: 2021-10-18 07:44 +0900
#modified: 2021-07-30 18:49 +0900
description: ì‹œë©˜í‹± ì„¸ê·¸ë©˜í…Œì´ì…˜ ëŒ€íšŒë¥¼ ìœ„í•œ ëª¨ë¸ì„ ë§Œë“œëŠ” ê³¼ì •
tag:
  - Boostcamp AI
  - P-stage
  - Object Detection Competition
# image: /cara-memperbarui-fork-repository/repo.png
usemathjax: true
---

# FCN ìš”ì•½

### íŠ¹ì§•

<figure>
<img src="/assets/img/Screen Shot 2021-10-18 at 8.15.40 PM.png">
<figcaption>Fig 1. Fully Convolutional Networks for Semantic Segmentation</figcaption>
</figure>

1. VGG ë„¤íŠ¸ì›Œí¬ ë°±ë³¸ì„ ì‚¬ìš© (Backbone: feature extracting network)
2. VGG ë„¤íŠ¸ì›Œí¬ì˜ FC Layer (nn.Linear)ë¥¼ Convolutionìœ¼ë¡œ ëŒ€ì²´
3. Trasposed Convolutionì„ ì´ìš©í•´ì„œ Pixel wise predictionì„ ìˆ˜í–‰ 

### VGG

<figure>
<img src="/assets/img/Screen Shot 2021-10-18 at 8.29.30 PM.png">
<figcaption>Fig 2. VGG Backbone Network</figcaption>
</figure>

- 3x3 convolution
- maxpoolingìœ¼ë¡œ resolutionì´ ë°˜ìœ¼ë¡œ ì¤„ì–´ë“ ë‹¤
- Fully connected layerì—ì„œëŠ” nn.LinearëŒ€ì‹  nn.Conv2dë¥¼ ì¼ë‹¤

### Convoluton Layer vs Fully Connected Layer

<figure>
<img src="/assets/img/Screen Shot 2021-10-18 at 8.32.32 PM.png">
<figcaption>Fig 3. CL vs FCL</figcaption>
</figure>

- Convolution layer
    - ê° í”½ì…€ì˜ ìœ„ì¹˜ì •ë³´ë¥¼ í•´ì¹˜ì§€ ì•Šì€ì±„ë¡œ íŠ¹ì§•ì„ ì¶”ì¶œí•œë‹¤
    - 1x1 Convolutionì„ ì‚¬ìš©í•˜ë©´ì„œ kernelì˜ íŒŒë¼ë¯¸í„°ì— ì˜í•´ ì˜í–¥ì„ ë°›ê³  ì´ë¯¸ì§€ í˜¹ì€ ë ˆì´ì–´ì˜ í¬ê¸°ì— ëŒ€í•´ì„œ ìƒê´€ì´ ì—†ë‹¤
    - `nn.Conv2d(input_channel, output_channel, kernel_size, ..)`
    - ì¦‰, heightì™€ width ê°’ì´ ë¬´ì—‡ì´ë“  ìƒê´€ì´ ì—†ë‹¤
- Fully connected layer
    - flatten ì´í›„ì— fc layerë¥¼ ì ìš©ì‹œí‚¤ë¯€ë¡œ ê° í”½ì…€ì˜ ìœ„ì¹˜ì •ë³´ë¥¼ í•´ì¹œë‹¤
    - `nn.Linear(input_channel * height * width, output_size)`
    - ì¦‰, ì •í•´ì§„ heightì™€ width ê°’ì„ ì¨ì•¼í•œë‹¤

### Transposed Convolution

- 5ë²ˆì˜ maxpoolingìœ¼ë¡œ 2ì˜ 5ìŠ¹ ì¦‰, ì¸í’‹ë³´ë‹¤ 1/32ì˜ í™”ì§ˆì„ ê°–ê²Œ ëœë‹¤
- í•˜ì§€ë§Œ ìµœì¢… ì•„ì›ƒí’‹ì€ 224x224ì˜ í”½ì…€ê°’ì„ ê°€ì ¸ì•¼ í•œë‹¤
    - ê° í”½ì…€ì€ ì–´ë– í•œ í´ë˜ìŠ¤ì¸ì§€ ë¶„ë¥˜ë˜ì–´ìˆë‹¤
- ì´ëŸ¬í•œ ëŠ˜ë ¤ì£¼ëŠ” ì‘ì—…ì„ **Transposed Convolution**ì´ë¼ê³  í•œë‹¤
- Convolutionê³¼ ë§ˆì°¬ê°€ì§€ë¡œ í•™ìŠµì´ ê°€ëŠ¥í•œ íŒŒë¼ë¯¸í„°ì´ë‹¤
    - í•™ìŠµ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì€ ê³§ Upsamplingì„ ë” ì˜í•´ì§„ë‹¤ëŠ” ê²ƒ

ğŸˆ ì—„ë°€í•œ ëª…ì¹­ì€ Transposed Convolutionì´ë¼ê³  ë¶€ë¥´ëŠ”ê²Œ ì •í™•í•˜ì§€ë§Œ ë§ì´ë“¤ Deconvolutionì´ë¼ëŠ” ìš©ì–´ì™€ ê°™ì´ ì‚¬ìš©í•˜ë‹ˆ ì°¸ê³ 

### FCNì—ì„œ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ë°©ë²•

<figure>
<img src="/assets/img/Screen Shot 2021-10-18 at 9.02.43 PM.png">
<figcaption>Fig 4. Low level featureë¥¼ í•©ì³ì¤Œìœ¼ë¡œì¨ ë””í…Œì¼ì´ ì‚´ì•„ë‚œë‹¤</figcaption>
</figure>

- Upsamplingí•  ë•Œ ë„ˆë¬´ í•œë²ˆì— í‚¤ìš°ë©´ ì •ë³´ê°€ ë„ˆë¬´ ì†ì‹¤ë˜ì§€ ì•Šì„ê¹Œ?
- Maxpoolingí•˜ê¸° ì „ì˜ layerë¥¼ ë½‘ì•„ í•©ì³ì„œ ì†ì‹¤ëœ ì •ë³´ë¥¼ ë³µì›í•˜ì!

<figure>
<img src="/assets/img/Screen Shot 2021-10-18 at 9.12.02 PM.png">
<figcaption>Fig 5. FCN-8s</figcaption>
</figure>

ğŸˆ ì½”ë“œëŠ” ppt ì°¸ê³ 