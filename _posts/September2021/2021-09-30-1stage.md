---
layout: post
title: ğŸ” Object Detect Comp | 1 Stage Detectors
date: 2021-09-30 07:44 +0900
#modified: 2021-07-30 18:49 +0900
description: ê°ì²´ ê²€ì¶œ ëŒ€íšŒë¥¼ ìœ„í•œ ëª¨ë¸ì„ ë§Œë“œëŠ” ê³¼ì •
tag:
  - Boostcamp AI
  - P-stage
  - Object Detection Competition
# image: /cara-memperbarui-fork-repository/repo.png
usemathjax: true
---

FPN â†’ ë‹¤ì–‘í•œ ê°ì²´ë¥¼ ì˜ ê²€ì¶œí•˜ê¸° ìœ„í•´ì„œ

2-stage ì†ë„ê°€ ëŠë ¤ì„œ 

1-stage â†’ real-time object detector

Background

2 stage detectors

1) Localization

2) Classification

â†’ ì†ë„ê°€ ë§¤ìš° ëŠë¦¼,,, 

High-level layerì—ì„œ,,,

2-stage detector

1-stage detector: conv layers â†’ feature map â†’ ê°ì²´ì˜ ìœ„ì¹˜ì™€ ì¢…ë¥˜ ì˜ˆì¸¡ (RPNê³¼ì •ì´ ìƒëµ)

1 stage

- Localization classification ë™ì‹œ ì§„í–‰
- ì†ë„ê°€ ë§¤ìš° ë¹ ë¦„
- ì „ì²´ ì´ë¯¸ì§€ë¥¼ ë³´ê¸° ë•Œë¬¸ì— ë§¥ë½ ì´í•´ë„ê°€ ë†’ìŒ

YOLO

- You Only Look Once

ì ‘ê·¼ ì „ëµ

- ì…ë ¥ ì´ë¯¸ì§€ê°€ ìˆì„ ë•Œ ìœ„ì¹˜ì™€ í´ë˜ìŠ¤ ì˜ˆì¸¡ ë™ì‹œì— ì´ë£¨ì–´ì§
- Region proposal ë‹¨ê³„ x
- GoogLeNet ë³€í˜•

Pipeline

- SxS ê·¸ë¦¬ë“œë¡œ ë‚˜ëˆ”
- ê·¸ë¦¬ë“œ ì˜ì—­ë§ˆë‹¤ Bê°œì˜ Bboxì™€ Confidence score ê³„ì‚°
- Bbox ì™€ class probability

ì²«ë²ˆì§¸ bounding boxê°€ ì²«ë²ˆì§¸ classì¼ í™•ë¥  and so on,,,

ê³±í•´ì¤˜ì„œ ê·¸ë¦¬ë“œ ì…€ë§ˆë‹¤ ì—°ì‚°ì„ í•´ì¤€ë‹¤

ì´ ê·¸ë¦¬ë“œ ì…€ì´ 49ê°œì´ê¸° ë•Œë¬¸ì— 49x2 = 98ê°œì˜ ë°•ìŠ¤ê°€ ë‚˜ì˜´

thresholdë¥¼ ì •í•´ 0.2 ì´í•˜ë¡œëŠ” ê³ ë ¤í•˜ì§€ ì•Šê² ë‹¤ ë“±

sortâ†’NMS ì§„í–‰

ìµœì¢…ì ìœ¼ë¡œ ë‚¨ì•„ìˆëŠ” bboxë¥¼ ê·¸ë¦¬ë©´ object detection ì™„ì„±

localization loss

ê° ê·¸ë¦¬ë“œ ì…€ ë³„ë¡œ ê° ë°•ìŠ¤ ë³„ë¡œ objectë¥¼ í¬í•¨í•˜ê³  ìˆì„ ë•Œ regression loss êµ¬í˜„

ë˜‘ê°™ì´ widthì™€ height regression êµ¬í˜„

Confidence loss

ê° ê·¸ë¦¬ë“œ ì…€ ê° ë°•ìŠ¤ ë³„ë¡œ object

ê° ê·¸ë¦¬ë“œ ì…€ ê° ë°•ìŠ¤ ë³„ë¡œ objectê°€ ì—†ì„ ë•Œ

Classification loss

ê° ê·¸ë¦¬ë“œ ì…€ ë³„ë¡œ objectê°€ ìˆì„ ë•Œ

ê·¸ í´ë˜ìŠ¤ì— ëŒ€í•œ í™•ë¥ ì— ëŒ€í•œ MSE ê³„ì‚°

SSD

YOLO ë‹¨ì  

ì°¨ì´ì 

ì…ë ¥ ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆ

YOLO â†’ Fully connected layerê°€ ì†ë„ë¥¼ ëŠë¦¬ê²Œ ë§Œë“¬

SSD 1x1 convolutionì„ ëŒ€ì‹  ì‚¬ìš©

YOLO â†’ backbone í†µê³¼í•œ feature mapì—ì„œ ì—°ì‚°

SSD extra convolution ì‚¬ìš©

SSD íŠ¹ì§•

5x5 feature map ì˜ˆì‹œ

3x3 convolutionìœ¼ë¡œ íŠ¹ì • ì±„ë„ ìˆ˜ë¡œ ë°”ê¿”ì£¼ëŠ”ë°,,

C = Nbbox * (Offsets+Nc)

Nbbox = anchor ë°•ìŠ¤ì˜ ê°œìˆ˜

default box ~= anchor box

SSDëŠ” 8732ì˜ ë°•ìŠ¤ë¥¼ ì˜ˆì¸¡

í° feature mapì—ì„œëŠ” ì‘ì€ ë¬¼ì²´ ì°¾ê³ 

ì‘ì€ feature mapì—ì„œëŠ” í° ë¬¼ì²´ë¥¼ ì°¾ëŠ”ë‹¤

Training

YOLO v2

Better Faster Stronger

- Batch normalization
- High resolution classifier
- Convolution with anchor boxes
- Fine-grained features
- Multi-scale training
- GoogLeNet â†’ Darknet-19
- ImageNet COCO ìœ¼ë¡œ ì¼ë°˜ì  + ì„¸ë¶€ì  ê°ì²´
    - WordTree êµ¬ì„±
    - 9418ì˜ ê°ˆë˜ë¥¼ ë§Œë“¤ì–´ëƒ„
    - detection â†’ COCO
    - classification â†’ ImageNet

YOLO v3

- Darnet-53
- multi-scale feature maps

RetinaNet

1 Stage Detector Problems

- ê° ê·¸ë¦¬ë“œ ì…€ì„ ê³ ë ¤í•˜ë¯€ë¡œ ë°±ê·¸ë¼ìš´ë“œë¥¼ í¬í•¨í•  í™•ë¥ ì´ ë†’ë‹¤

Focal Loss